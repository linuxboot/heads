CONFIG_ZLIB ?= y
modules-$(CONFIG_ZLIB) += zlib

# Inventory classification: hardcoded -O3 (62 occurrences)

zlib_version := 1.2.11
zlib_dir := zlib-$(zlib_version)
zlib_tar := zlib-$(zlib_version).tar.gz
zlib_url := https://zlib.net/fossils/$(zlib_tar)
zlib_hash := c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1

# TODO(-OFLAG): OFLAG status: CONFIRMED â€” `zlib` build lines **widely** use `-O3` (62 occurrences across build logs), which conflicts with `-Oz`.
# Evidence (representative): build/x86/log/zlib.log and build/ppc64/log/zlib.log contain many compile lines with `-O3`.
# Action: propose a narrow patch to remove `-O3` from `Makefile.in`/`configure` (or adjust packaging to override the optimization flag), then verify with cross-builds that `-Oz` is used and binaries are functional. Priority: High.


zlib_configure := \
	$(CROSS_TOOLS) \
	./configure \
	--prefix="/" \

zlib_target := \
	$(MAKE_JOBS) \
	$(CROSS_TOOLS) \
	DESTDIR="$(INSTALL)" \
	install \

zlib_libraries := libz.so.1

zlib_depends := $(musl_dep)
